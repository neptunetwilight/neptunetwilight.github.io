<!DOCTYPE html><html lang="zh-tw"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><meta name="author" content="TwilightCoder"><meta name="renderer" content="webkit"><meta name="copyright" content="TwilightCoder"><meta name="keywords" content="Twilight's blog"><meta name="description" content="neptunetwilight study blog"><meta name="Cache-Control" content="no-cache"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><title>MyBatis · Twilight's Blog</title><link rel="stylesheet" href="/css/style.css?v=2018.7.9"><link rel="stylesheet" href="/css/animation.css?v=2018.7.9"><link rel="icon" href="/img/assets/favicon.ico"><link rel="stylesheet" href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css?version=1.5.6"><!-- scripts--><script>(function( w ){
  "use strict";
  // rel=preload support test
  if( !w.loadCSS ){
    w.loadCSS = function(){};
  }
  // define on the loadCSS obj
  var rp = loadCSS.relpreload = {};
  // rel=preload feature support test
  // runs once and returns a function for compat purposes
  rp.support = (function(){
    var ret;
    try {
      ret = w.document.createElement( "link" ).relList.supports( "preload" );
    } catch (e) {
      ret = false;
    }
    return function(){
      return ret;
    };
  })();

  // if preload isn't supported, get an asynchronous load by using a non-matching media attribute
  // then change that media back to its intended value on load
  rp.bindMediaToggle = function( link ){
    // remember existing media attr for ultimate state, or default to 'all'
    var finalMedia = link.media || "all";

    function enableStylesheet(){
      link.media = finalMedia;
    }

    // bind load handlers to enable media
    if( link.addEventListener ){
      link.addEventListener( "load", enableStylesheet );
    } else if( link.attachEvent ){
      link.attachEvent( "onload", enableStylesheet );
    }

    // Set rel and non-applicable media type to start an async request
    // note: timeout allows this to happen async to let rendering continue in IE
    setTimeout(function(){
      link.rel = "stylesheet";
      link.media = "only x";
    });
    // also enable media after 3 seconds,
    // which will catch very old browsers (android 2.x, old firefox) that don't support onload on link
    setTimeout( enableStylesheet, 3000 );
  };

  // loop through link elements in DOM
  rp.poly = function(){
    // double check this to prevent external calls from running
    if( rp.support() ){
      return;
    }
    var links = w.document.getElementsByTagName( "link" );
    for( var i = 0; i < links.length; i++ ){
      var link = links[ i ];
      // qualify links to those with rel=preload and as=style attrs
      if( link.rel === "preload" && link.getAttribute( "as" ) === "style" && !link.getAttribute( "data-loadcss" ) ){
        // prevent rerunning on link
        link.setAttribute( "data-loadcss", true );
        // bind listeners to toggle media back
        rp.bindMediaToggle( link );
      }
    }
  };

  // if unsupported, run the polyfill
  if( !rp.support() ){
    // run once at least
    rp.poly();

    // rerun poly on an interval until onload
    var run = w.setInterval( rp.poly, 500 );
    if( w.addEventListener ){
      w.addEventListener( "load", function(){
        rp.poly();
        w.clearInterval( run );
      } );
    } else if( w.attachEvent ){
      w.attachEvent( "onload", function(){
        rp.poly();
        w.clearInterval( run );
      } );
    }
  }


  // commonjs
  if( typeof exports !== "undefined" ){
    exports.loadCSS = loadCSS;
  }
  else {
    w.loadCSS = loadCSS;
  }
}( typeof global !== "undefined" ? global : this ) );</script><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js" defer></script><script src="/js/main.js?v=2018.7.9" defer></script><!-- fancybox--><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" defer></script><!-- busuanzi--><script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script><meta name="generator" content="Hexo 5.3.0"><link rel="alternate" href="/atom.xml" title="Twilight's blog" type="application/atom+xml">
</head><body><section class="profile-close" id="cxo-profile"><div class="profile-avatar"><i class="fa fa-caret-left"></i><img src="/img/assets/ailise.jpg"></div><!--.profile-saying
  i.fa.fa-comment
  .saying--><div class="cxo-profile-inner"><div class="profile-name">TwilightCoder</div><div class="profile-signature">stay cool</div><div class="friends"><div>FRIENDS</div><span><a href="//github.com/Longlongyu" target="_black">friendA</a></span><span><a href="//github.com/ruanguohui" target="_black">friendB</a></span><span><a href="//github.com/" target="_black">friendC</a></span></div><div class="read-progress"></div></div></section><header id="cxo-intro" style="height: 70vh;background-image: url(/img/intro/63292959_p0.png);"><nav id="cxo-intro-nav"><section><div class="intro-nav-title"><a href="/">Twilight's Blog</a></div><div class="intro-nav-label-box"><a href="/">Home</a><a href="/about/">About</a><a href="/archives/">Archives</a><a href="/tags/">Tags</a></div><i class="fa fa-bars intro-nav-menu"><div class="intro-nav-drop"><a href="/">Home</a><a href="/about/">About</a><a href="/archives/">Archives</a><a href="/tags/">Tags</a></div></i><div class="clear"></div></section></nav><h1 class="post-title">MyBatis</h1><div class="post-intros"><div class="post-intro-meta"><span class="post-intro-time"><i class="post-intro-calendar fa fa-edit"></i><span>2021-02-06 18:23:08</span></span><span class="post-intro-tags"><a class="intro-tag fa fa-tag" href="javascript:void(0)" date-tags="Java-FrameのMybatis"> Java-FrameのMybatis</a></span></div><div class="post-intro-read"><span> Word count: <span class="post-count">7k</span> | Reading time: <span class="post-count">35</span>min</span></div></div></header><article class="cxo-up" id="cxo-content-outer"><section id="cxo-content-inner"><article class="article-entry" id="post"><h2 id="MyBatis简介"><a href="#MyBatis简介" class="headerlink" title="MyBatis简介:"></a>MyBatis简介:</h2><ul>
<li><strong>Mybatis本是apache的一个开源项目iBatis，2013年11月迁移到了Github。大家可以去github上下载各个版本，iBatis是一个基于Java的持久层框架，提供的持久层框架包括SQL Maps和Data Access Objects（DAO）。Mybatis消除了几乎所有JDBC代码和参数的手工设置以及对结果集的检索，它可以使用简单的XML或注解用于配置和原始映射，将接口和Java的POJO（Plain Old Java Objects，普通的Java对象）映射城数据库中的记录。Mybatis提供了一种“半自动化”的ORM实现。这相对于Hibernate提供的“全自动化”而言，增加了程序操作人员对sql语句的自由操作和优化</strong></li>
</ul>
<p><img src="/img/frame/mybatis.jpg" alt="MyBatis框架图"></p>
<h2 id="Mybatis配置"><a href="#Mybatis配置" class="headerlink" title="Mybatis配置:"></a>Mybatis配置:</h2><p>Mybatis本身就很小而简单，没有任何第三方依赖，最简单安装只需要两个jar文件和配置几个sql映射文件</p>
<ul>
<li><p><strong>mybatis-3.4.6.jar</strong></p>
</li>
<li><p><strong>mysql-connector-java-8.0.9-rc.jar</strong></p>
</li>
</ul>
<p><strong>xml:</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span> <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span> <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!--1、typeAliases别名处理器，可以为我们的java类型起别名 </span></span><br><span class="line"><span class="comment">		alias后加上你自己命名的名字         type后加实体类路径</span></span><br><span class="line"><span class="comment">	启用别名可以避免每次返回类型变得冗长而复杂</span></span><br><span class="line"><span class="comment">	 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">typeAlias</span> <span class="attr">alias</span>=<span class="string">&quot;ccc&quot;</span> <span class="attr">type</span>=<span class="string">&quot;shadowverse.entity.card&quot;</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!--2、environments，环境，mybatis可以配置多种环境</span></span><br><span class="line"><span class="comment">		其中可以加入environment配置更加具体环境信息 后面的id为便于切换运行环境</span></span><br><span class="line"><span class="comment">		然后再为其配置事务管理器transactionManager			type=JDBC/MANAGED</span></span><br><span class="line"><span class="comment">				以及数据源dataSource		type=POOLED/UNPOOLED/JNDI</span></span><br><span class="line"><span class="comment">	  --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">&quot;development&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">&quot;development&quot;</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">&quot;JDBC&quot;</span> /&gt;</span></span><br><span class="line">			<span class="comment">&lt;!-- 配置数据库连接信息 --&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">&quot;POOLED&quot;</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driver&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span> /&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;jdbc:mysql://localhost:3306/cygames?characterEncoding=utf-8<span class="symbol">&amp;amp;</span>serverTimezone=UTC<span class="symbol">&amp;amp;</span>useSSL=FALSE&quot;</span> /&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span> /&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span> /&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">&quot;shadowverse/mapper/CardMapper.xml&quot;</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>! ! ! 注意：这里我用的是mysql 8.0以上版本，所以要配置时区和转码以及ssl等，并且driver由原来的com.mysql.jdbc.Driver变为com.mysql.cj.jdbc.Driver。</strong></p>
<p><strong>实体类：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> shadowverse.entity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">card</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> c_id;</span><br><span class="line">	<span class="keyword">private</span> String c_name;</span><br><span class="line">	<span class="keyword">private</span> String s_class;</span><br><span class="line">	<span class="keyword">private</span> String c_cost;</span><br><span class="line">	<span class="keyword">private</span> String c_effect;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getC_id</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> c_id;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setC_id</span><span class="params">(<span class="keyword">int</span> c_id)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.c_id = c_id;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getC_name</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> c_name;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setC_name</span><span class="params">(String c_name)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.c_name = c_name;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getS_class</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> s_class;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setS_class</span><span class="params">(String s_class)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.s_class = s_class;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getC_cost</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> c_cost;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setC_cost</span><span class="params">(String c_cost)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.c_cost = c_cost;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getC_effect</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> c_effect;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setC_effect</span><span class="params">(String c_effect)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.c_effect = c_effect;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">card</span><span class="params">(<span class="keyword">int</span> c_id, String c_name, String s_class, String c_cost, String c_effect)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>();</span><br><span class="line">		<span class="keyword">this</span>.c_id = c_id;</span><br><span class="line">		<span class="keyword">this</span>.c_name = c_name;</span><br><span class="line">		<span class="keyword">this</span>.s_class = s_class;</span><br><span class="line">		<span class="keyword">this</span>.c_cost = c_cost;</span><br><span class="line">		<span class="keyword">this</span>.c_effect = c_effect;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">card</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>();</span><br><span class="line">		<span class="comment">// TODO Auto-generated constructor stub</span></span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>映射文件mapper：</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span> <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- namespace指定为接口全类名，以实现与接口动态绑定 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;shadowverse.dao.CardDao&quot;</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- id唯一标识   接口中的 方法名，返回类型，参数类型保持一致   --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;save&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;ccc&quot;</span>&gt;</span></span><br><span class="line">		insert into shadowverse values(</span><br><span class="line">					#&#123;c_id&#125;,</span><br><span class="line">					#&#123;c_name&#125;,</span><br><span class="line">					#&#123;s_class&#125;,</span><br><span class="line">					#&#123;c_cost&#125;,</span><br><span class="line">					#&#123;c_effect&#125;</span><br><span class="line">		)</span><br><span class="line">	<span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- 返回类型和接口一致 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findAll&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;ccc&quot;</span>&gt;</span></span><br><span class="line">		select * from shadowverse</span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findById&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;ccc&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;ccc&quot;</span>&gt;</span></span><br><span class="line">		select * from shadowverse where c_id = #&#123;cid&#125;</span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- 这里参数前还可以用$&#123;&#125;来给参数赋值，但是一般建议用#&#123;&#125;可防止sql注入 即$&#123;&#125;的值会直接显示用在sql上，#&#123;&#125;值是会动态调用在sql占位区中 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findById2&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;ccc&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;ccc&quot;</span>&gt;</span></span><br><span class="line">		select * from shadowverse where c_id = $&#123;cid&#125;</span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">&quot;updatebyId&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span>&gt;</span></span><br><span class="line">		update shadowverse set c_name=#&#123;c_name&#125;,s_class=#&#123;s_class&#125;,c_cost=#&#123;c_cost&#125;,c_effect=#&#123;c_effect&#125;</span><br><span class="line">		<span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">			c_id = #&#123;c_id&#125;;</span><br><span class="line">		<span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">&quot;delete&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span>&gt;</span></span><br><span class="line">		delete from shadowverse where c_id=#&#123;c_id&#125;</span><br><span class="line">	<span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findByIdandClass&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;java.util.Map&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;ccc&quot;</span>&gt;</span></span><br><span class="line">		select * from shadowverse where c_id=#&#123;cd&#125; and s_class=#&#123;cs&#125;</span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span> </span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findByNameandClass&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;shadowverse.entity.card&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;ccc&quot;</span>&gt;</span></span><br><span class="line">		select * from shadowverse where c_name=#&#123;c_name&#125; and s_class=#&#123;s_class&#125;</span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findByCost&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;java.util.List&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;ccc&quot;</span>&gt;</span></span><br><span class="line">		select * from shadowverse where c_cost=#&#123;list[0]&#125;</span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>持久层接口（DAO）：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> shadowverse.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Param;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> shadowverse.entity.card;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CardDao</span> </span>&#123;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 增加卡牌数据</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> c</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@throws</span> RuntimeException</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save</span><span class="params">(card c)</span> <span class="keyword">throws</span> RuntimeException</span>;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 根据id更新卡牌数据（修改）</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> cx</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@throws</span> RuntimeException</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updatebyId</span><span class="params">(card cx)</span> <span class="keyword">throws</span> RuntimeException</span>;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 根据id删除卡牌数据</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> cid</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@throws</span> RuntimeException</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">(<span class="keyword">int</span> c_id)</span> <span class="keyword">throws</span> RuntimeException</span>;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 查询所有卡牌数据</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@throws</span> RuntimeException</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;card&gt; <span class="title">findAll</span><span class="params">()</span><span class="keyword">throws</span> RuntimeException</span>;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 根据id查询卡牌数据</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> c_id</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@throws</span> RuntimeException</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="comment">//这里运用了命名参数，给了c_id新的名字cid，所以在mapper映射那边也使用相对应的#&#123;cid&#125;</span></span><br><span class="line">	<span class="comment">//多个参数命名也可以采用上述方式或者使用#&#123;param1&#125;、#&#123;param2&#125; 或者#&#123;0&#125;，#&#123;1&#125;等</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> card <span class="title">findById</span><span class="params">(<span class="meta">@Param(&quot;cid&quot;)</span> <span class="keyword">int</span> c_id)</span><span class="keyword">throws</span> RuntimeException</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * $&#123;&#125;根据id查询卡牌信息</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> c_id</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@throws</span> RuntimeException</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> card <span class="title">findById2</span><span class="params">(<span class="meta">@Param(&quot;cid&quot;)</span> <span class="keyword">int</span> c_id)</span><span class="keyword">throws</span> RuntimeException</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//当然对于参数类型还能传入map</span></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 根据id和职介查询卡牌信息</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> cdd</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@throws</span> RuntimeException</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> card <span class="title">findByIdandClass</span><span class="params">(Map&lt;String,Object&gt; cdd)</span><span class="keyword">throws</span> RuntimeException</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//多个参数的情况下还可以传入一整个对象，然后再映射中使用#&#123;相对应的属性&#125;</span></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 根据名字和职介查询卡牌信息</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> cad</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@throws</span> RuntimeException</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> card <span class="title">findByNameandClass</span><span class="params">(card cad)</span><span class="keyword">throws</span> RuntimeException</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//如果是list参数的情况下，mybatis也会进行特殊处理，会把参数封装成list，然后mapper映射中参数#&#123;list[0]&#125;</span></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 根据名字和费用查询卡牌信息</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> ll</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@throws</span> RuntimeException</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> card <span class="title">findByCost</span><span class="params">(List&lt;String&gt; ll)</span><span class="keyword">throws</span> RuntimeException</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>测试类:</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> shadowverse.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> shadowverse.dao.CardDao;</span><br><span class="line"><span class="keyword">import</span> shadowverse.entity.card;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CardTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		</span><br><span class="line">		InputStream is = CardTest.class.getResourceAsStream(<span class="string">&quot;/mybatis.xml&quot;</span>);</span><br><span class="line">		<span class="comment">//构建sqlSession的工厂</span></span><br><span class="line">		SqlSessionFactory sessionFactory=<span class="keyword">new</span> SqlSessionFactoryBuilder().build(is);</span><br><span class="line">			</span><br><span class="line">		<span class="comment">//获取一个sqlSession</span></span><br><span class="line">		SqlSession session = sessionFactory.openSession();</span><br><span class="line">			</span><br><span class="line">		<span class="comment">//新增卡牌信息</span></span><br><span class="line">		CardDao cdao=session.getMapper(CardDao.class);</span><br><span class="line">		card cc=<span class="keyword">new</span> card();</span><br><span class="line">		cc.setC_id(<span class="number">6</span>);</span><br><span class="line">		cc.setC_name(<span class="string">&quot;深夜的鬼姬 斑比&quot;</span>);</span><br><span class="line">		cc.setS_class(<span class="string">&quot;vampire&quot;</span>);</span><br><span class="line">		cc.setC_cost(<span class="string">&quot;6&quot;</span>);</span><br><span class="line">		cc.setC_effect(<span class="string">&quot;入场曲：将场上所有随从变成蝙蝠1/1，并且每有一个蝙蝠对对方主战造成蝙蝠数量*2的伤害&quot;</span>);</span><br><span class="line">		<span class="comment">/*cdao.save(cc);</span></span><br><span class="line"><span class="comment">		session.commit();*/</span></span><br><span class="line">		</span><br><span class="line">		System.out.println(<span class="string">&quot;--------------------------------&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//全查所有卡牌信息</span></span><br><span class="line">		List&lt;card&gt; ulist = cdao.findAll();</span><br><span class="line">		<span class="keyword">for</span> (card c : ulist) &#123;</span><br><span class="line">			System.out.println(<span class="string">&quot;费用：&quot;</span>+c.getC_cost()+<span class="string">&quot;\t&quot;</span>+c.getC_name()+<span class="string">&quot;   &quot;</span>+c.getC_effect());</span><br><span class="line">		&#125;</span><br><span class="line">		System.out.println(<span class="string">&quot;==========&quot;</span>);</span><br><span class="line">			</span><br><span class="line">		<span class="comment">//根据id查询id为1的对象结果</span></span><br><span class="line">		card cd=cdao.findById(<span class="number">1</span>);	</span><br><span class="line">		System.out.println(cd.getC_cost()+cd.getC_effect());</span><br><span class="line">		System.out.println(<span class="string">&quot;****************&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		card co=cdao.findById2(<span class="number">4</span>);	</span><br><span class="line">		System.out.println(co.getC_cost()+co.getC_effect());</span><br><span class="line">		System.out.println(<span class="string">&quot;==========&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//修改卡牌id为6的卡牌信息</span></span><br><span class="line">		card cx=<span class="keyword">new</span> card();</span><br><span class="line">		cx.setC_id(<span class="number">6</span>);</span><br><span class="line">		cx.setC_name(<span class="string">&quot;苇名一心&quot;</span>);</span><br><span class="line">		cx.setS_class(<span class="string">&quot;royal&quot;</span>);</span><br><span class="line">		cx.setC_cost(<span class="string">&quot;1&quot;</span>);</span><br><span class="line">		cx.setC_effect(<span class="string">&quot;突进 爆能：3，此卡攻击力+2，附有亡语效果：此卡这回合如果被破坏，下回合入场，进化。进化：此卡攻击力上升至本场游戏进化次数&quot;</span>);</span><br><span class="line">		cdao.updatebyId(cx);</span><br><span class="line">		session.commit();</span><br><span class="line">		cx=cdao.findById(<span class="number">6</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;费用：&quot;</span>+cx.getC_cost()+<span class="string">&quot;\t&quot;</span>+cx.getC_name()+<span class="string">&quot;   &quot;</span>+cx.getC_effect());</span><br><span class="line">		System.out.println(<span class="string">&quot;==========&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//删除卡牌信息</span></span><br><span class="line">		cdao.delete(<span class="number">3</span>);</span><br><span class="line">		session.commit();</span><br><span class="line">		System.out.println(<span class="string">&quot;wwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwww&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//传入map参数</span></span><br><span class="line">		Map&lt;String,Object&gt; mm=<span class="keyword">new</span> HashMap&lt;String, Object&gt;();</span><br><span class="line">		mm.put(<span class="string">&quot;cd&quot;</span>, <span class="string">&quot;6&quot;</span>);</span><br><span class="line">		mm.put(<span class="string">&quot;cs&quot;</span>, <span class="string">&quot;royal&quot;</span>);</span><br><span class="line">		card cdd=cdao.findByIdandClass(mm);</span><br><span class="line">		System.out.println(cdd.getC_name()+<span class="string">&quot;:&quot;</span>+cdd.getC_effect());</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//传入POJO，利用其属性为mapper映射参数命名</span></span><br><span class="line">		card csd=<span class="keyword">new</span> card();</span><br><span class="line">		csd.setC_name(<span class="string">&quot;魔法转生 美杜莎&quot;</span>);</span><br><span class="line">		csd.setS_class(<span class="string">&quot;vampire&quot;</span>);</span><br><span class="line">		cdd=cdao.findByNameandClass(csd);</span><br><span class="line">		System.out.println(cdd.getC_name()+<span class="string">&quot;:&quot;</span>+cdd.getC_effect());</span><br><span class="line">		System.out.println(<span class="string">&quot;--------------------------------------&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//传入list参数的时候</span></span><br><span class="line">		List&lt;String&gt; ls=<span class="keyword">new</span> ArrayList();</span><br><span class="line">		ls.add(<span class="string">&quot;5&quot;</span>);</span><br><span class="line">		ls.add(<span class="string">&quot;6&quot;</span>);</span><br><span class="line">		ls.add(<span class="string">&quot;9&quot;</span>);</span><br><span class="line">		card ss=cdao.findByCost(ls);</span><br><span class="line">		System.out.println(<span class="string">&quot;费用：&quot;</span>+ss.getC_cost()+<span class="string">&quot;\t&quot;</span>+ss.getC_name()+<span class="string">&quot;   &quot;</span>+ss.getC_effect());</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Mybatis里的动态sql："><a href="#Mybatis里的动态sql：" class="headerlink" title="Mybatis里的动态sql："></a>Mybatis里的动态sql：</h2><p><strong>Mybatis里还支持动态sql写法，对于以前所写的JDBC相比，动态sql无疑是开发人员最痛苦的事情，每次变更条件时都要重新写新的sql语句，再进行一系列操作。但Mybatis支持动态sql，并有一套标签为此来解决这个难题。</strong></p>
<ul>
<li><strong>if</strong></li>
<li><strong>choose（when，otherwise）</strong></li>
<li><strong>trim（when，set）</strong></li>
<li><strong>foreach</strong></li>
</ul>
<p><strong>持久层接口（DAO）：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//以下为动态sql的接口</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 根据不同需求来查询相对应卡牌信息</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> cd</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@throws</span> RuntimeException</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> List&lt;card&gt; <span class="title">findByRequireIf</span><span class="params">(card cd)</span><span class="keyword">throws</span> RuntimeException</span>;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 根据某个单个需求查询对应卡牌信息</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> cd</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@throws</span> RuntimeException</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> List&lt;card&gt; <span class="title">findByRequireChoose</span><span class="params">(card cr)</span><span class="keyword">throws</span> RuntimeException</span>;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 根据不同需求来查询相对应卡牌信息 trim截取版</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> cr</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@throws</span> RuntimeException</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> List&lt;card&gt; <span class="title">findByRequireTrim</span><span class="params">(card cr)</span><span class="keyword">throws</span> RuntimeException</span>;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 根据list中的id来依次查询卡牌信息</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> ll</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@throws</span> RuntimeException</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> List&lt;card&gt; <span class="title">findByRequireForeach</span><span class="params">(<span class="meta">@Param(&quot;cid&quot;)</span> List&lt;Integer&gt; ls)</span><span class="keyword">throws</span> RuntimeException</span>;</span><br></pre></td></tr></table></figure>
<p><strong>映射文件mapper：</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 动态sql，一般动态sql用于sql语句需要频繁变更不同需求时候所需要用到的--&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- if 根据所需不同条件来查询相对应的数据 也就是字段的添加，需要添加什么字段条件，会根据传递进来的参数判断哪些是需要的条件--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findByRequireIf&quot;</span>  <span class="attr">resultType</span>=<span class="string">&quot;ccc&quot;</span>&gt;</span></span><br><span class="line">	select * from shadowverse </span><br><span class="line">	where</span><br><span class="line">	<span class="comment">&lt;!-- 这里的test 用了OGNL表达式（Object Graph Navigation Language）对象图导航语言</span></span><br><span class="line"><span class="comment">	类似于EL JSTL表达式，基本用法：</span></span><br><span class="line"><span class="comment">		访问对象属性：person.name</span></span><br><span class="line"><span class="comment">		调用方法：	person.getName()</span></span><br><span class="line"><span class="comment">		调用静态属性/方法：@静态属性全类名@静态属性</span></span><br><span class="line"><span class="comment">					  @静态属性全类名@静态方法</span></span><br><span class="line"><span class="comment">		调用构造方法（构造器）：new cygames.shadowverse.royal.c_cost</span></span><br><span class="line"><span class="comment">		运算符：+,-,*,/,%</span></span><br><span class="line"><span class="comment">		逻辑运算符：in,not in,&gt;,&lt;,&gt;=,&lt;=,==,!=</span></span><br><span class="line"><span class="comment">		遇见特殊符号应该写转义字符：比如&amp;amp</span></span><br><span class="line"><span class="comment">	 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;c_name!=null <span class="symbol">&amp;amp;</span><span class="symbol">&amp;amp;</span> c_name!=<span class="symbol">&amp;quot;</span><span class="symbol">&amp;quot;</span>&quot;</span>&gt;</span></span><br><span class="line">		c_name like #&#123;c_name&#125; </span><br><span class="line">	<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;s_class!=null&quot;</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 如果名字为null，后面的语句会凭空多出现一个and在sql中，所以为了避免这种情况还可以给前后增加&lt;where&gt;标签 --&gt;</span></span><br><span class="line">		and s_class=#&#123;s_class&#125; </span><br><span class="line">	<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;c_cost!=null&quot;</span>&gt;</span></span><br><span class="line">		and c_cost=#&#123;c_cost&#125;</span><br><span class="line">	<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;c_effect!=null&quot;</span>&gt;</span></span><br><span class="line">		and c_effect like #&#123;c_effect&#125;</span><br><span class="line">	<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- choose相当于分支选择，和switch case一个含义，以when和otherwise与之对应 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findByRequireChoose&quot;</span>  <span class="attr">resultType</span>=<span class="string">&quot;ccc&quot;</span>&gt;</span></span><br><span class="line">	select * from shadowverse where</span><br><span class="line">	<span class="tag">&lt;<span class="name">choose</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">&quot;c_name!=null&quot;</span>&gt;</span></span><br><span class="line">			c_name like #&#123;c_name&#125; </span><br><span class="line">		<span class="tag">&lt;/<span class="name">when</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">&quot;s_class!=null&quot;</span>&gt;</span> </span><br><span class="line">			s_class=#&#123;s_class&#125; </span><br><span class="line">		<span class="tag">&lt;/<span class="name">when</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">&quot;c_cost!=null&quot;</span>&gt;</span></span><br><span class="line">			c_cost=#&#123;c_cost&#125;</span><br><span class="line">		<span class="tag">&lt;/<span class="name">when</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">&quot;c_effect!=null&quot;</span>&gt;</span></span><br><span class="line">			c_effect like #&#123;c_effect&#125;</span><br><span class="line">		<span class="tag">&lt;/<span class="name">when</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">otherwise</span>&gt;</span></span><br><span class="line">			c_id=#&#123;c_id&#125;</span><br><span class="line">		<span class="tag">&lt;/<span class="name">otherwise</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">choose</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- trim标签为字符串截取标签，主要是为了给sql添加或者删除某些前缀或后缀 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findByRequireTrim&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;ccc&quot;</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- trim有四个属性：</span></span><br><span class="line"><span class="comment">			prefix:前缀，prefix给拼串后的整个字符串加上前缀</span></span><br><span class="line"><span class="comment">			prefixOverrides:前缀覆盖，去掉整个字符串前面多余的字符</span></span><br><span class="line"><span class="comment">			suffix:后缀</span></span><br><span class="line"><span class="comment">			suffixOverrides:后缀覆盖</span></span><br><span class="line"><span class="comment">	 --&gt;</span></span><br><span class="line">	 select * from shadowverse </span><br><span class="line">	 <span class="tag">&lt;<span class="name">trim</span> <span class="attr">prefix</span>=<span class="string">&quot;where&quot;</span> <span class="attr">suffixOverrides</span>=<span class="string">&quot;and&quot;</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;c_name!=null <span class="symbol">&amp;amp;</span><span class="symbol">&amp;amp;</span> c_name!=<span class="symbol">&amp;quot;</span><span class="symbol">&amp;quot;</span>&quot;</span>&gt;</span></span><br><span class="line">				c_name like #&#123;c_name&#125; and</span><br><span class="line">			<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;s_class!=null&quot;</span>&gt;</span></span><br><span class="line">				s_class=#&#123;s_class&#125; and</span><br><span class="line">			<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;c_cost!=null&quot;</span>&gt;</span></span><br><span class="line">				c_cost=#&#123;c_cost&#125; and</span><br><span class="line">			<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;c_effect!=null&quot;</span>&gt;</span></span><br><span class="line">				c_effect like #&#123;c_effect&#125;</span><br><span class="line">			<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">	 <span class="tag">&lt;/<span class="name">trim</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- foreach相当于遍历循环 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findByRequireForeach&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;java.util.List&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;ccc&quot;</span>&gt;</span></span><br><span class="line">	select * from shadowverse where c_cost in</span><br><span class="line">	<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">		collection:指定要遍历的集合：list类型的参数会特殊处理封装在map中，mao的key就叫list</span></span><br><span class="line"><span class="comment">		item：将当前遍历出的元素赋值给指定变量</span></span><br><span class="line"><span class="comment">		separator：每个元素之间的分隔符</span></span><br><span class="line"><span class="comment">		open：遍历出所有结果拼接一个开始的字符</span></span><br><span class="line"><span class="comment">		close：遍历出所有结果拼接一个结束的字符</span></span><br><span class="line"><span class="comment">		index：索引，遍历list时候index为索引，item指当前值</span></span><br><span class="line"><span class="comment">						遍历map时候index就是map的key，item就是map的值</span></span><br><span class="line"><span class="comment">		#&#123;变量名&#125;就能取出变量的值也就是当前遍历出的元素</span></span><br><span class="line"><span class="comment">	 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">&quot;cid&quot;</span> <span class="attr">index</span>=<span class="string">&quot;index&quot;</span> <span class="attr">item</span>=<span class="string">&quot;item&quot;</span> <span class="attr">open</span>=<span class="string">&quot;(&quot;</span> <span class="attr">close</span>=<span class="string">&quot;)&quot;</span> <span class="attr">separator</span>=<span class="string">&quot;,&quot;</span>&gt;</span></span><br><span class="line">		#&#123;item&#125;</span><br><span class="line">	<span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>测试类(test)：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">InputStream is = CardTest.class.getResourceAsStream(<span class="string">&quot;/mybatis.xml&quot;</span>);</span><br><span class="line"><span class="comment">//构建sqlSession的工厂</span></span><br><span class="line">SqlSessionFactory sessionFactory=<span class="keyword">new</span> SqlSessionFactoryBuilder().build(is);</span><br><span class="line"></span><br><span class="line"><span class="comment">//获取一个sqlSession</span></span><br><span class="line">SqlSession session = sessionFactory.openSession();</span><br><span class="line"></span><br><span class="line"><span class="comment">//新增卡牌信息</span></span><br><span class="line">CardDao cdao=session.getMapper(CardDao.class);</span><br><span class="line"></span><br><span class="line"><span class="comment">//以下为动态sql测试</span></span><br><span class="line">System.out.println(<span class="string">&quot;sssssssssssssssssssssssssssssssssss&quot;</span>);</span><br><span class="line">card crd=<span class="keyword">new</span> card(<span class="number">1</span>,<span class="string">&quot;%团长%&quot;</span>,<span class="string">&quot;royal&quot;</span>,<span class="keyword">null</span>,<span class="string">&quot;%爆能%&quot;</span>);</span><br><span class="line">List&lt;card&gt; lst=cdao.findByRequireIf(crd);</span><br><span class="line"><span class="keyword">for</span>(card cad: lst)&#123;</span><br><span class="line">	System.out.println(<span class="string">&quot;费用：&quot;</span>+cad.getC_cost()+<span class="string">&quot;\t&quot;</span>+cad.getC_name()+<span class="string">&quot;   &quot;</span>+cad.getC_effect());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;wwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwww&quot;</span>);</span><br><span class="line">card cgd=<span class="keyword">new</span> card(<span class="number">6</span>,<span class="keyword">null</span>,<span class="keyword">null</span>,<span class="keyword">null</span>,<span class="string">&quot;%疾走%&quot;</span>);</span><br><span class="line">List&lt;card&gt; sls=cdao.findByRequireChoose(cgd);</span><br><span class="line"><span class="keyword">for</span>(card cbd:sls)&#123;</span><br><span class="line">	System.out.println(<span class="string">&quot;费用：&quot;</span>+cbd.getC_cost()+<span class="string">&quot;\t&quot;</span>+cbd.getC_name()+<span class="string">&quot;   &quot;</span>+cbd.getC_effect());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;_____________________________________&quot;</span>);</span><br><span class="line">card ced=<span class="keyword">new</span> card(<span class="number">1</span>,<span class="string">&quot;%野兽%&quot;</span>,<span class="string">&quot;vampire&quot;</span>,<span class="keyword">null</span>,<span class="string">&quot;%入场曲%&quot;</span>);</span><br><span class="line">List&lt;card&gt; tsi=cdao.findByRequireIf(ced);</span><br><span class="line"><span class="keyword">for</span>(card cod: tsi)&#123;</span><br><span class="line">	System.out.println(<span class="string">&quot;费用：&quot;</span>+cod.getC_cost()+<span class="string">&quot;\t&quot;</span>+cod.getC_name()+<span class="string">&quot;   &quot;</span>+cod.getC_effect());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;、、、、、、、、、、、、、、、、、、、、、、、、、、、、&quot;</span>);</span><br><span class="line">List&lt;Integer&gt; sli=<span class="keyword">new</span> ArrayList();</span><br><span class="line">sli.add(<span class="number">1</span>);</span><br><span class="line">sli.add(<span class="number">5</span>);</span><br><span class="line">sli.add(<span class="number">4</span>);</span><br><span class="line">sli.add(<span class="number">9</span>);</span><br><span class="line">List&lt;card&gt; ssd=cdao.findByRequireForeach(sli);</span><br><span class="line"><span class="keyword">for</span>(card ddd: ssd)&#123;</span><br><span class="line">	System.out.println(<span class="string">&quot;费用：&quot;</span>+ddd.getC_cost()+<span class="string">&quot;\t&quot;</span>+ddd.getC_name()+<span class="string">&quot;   &quot;</span>+ddd.getC_effect());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Mybatis的逆向工程mbg-Mybatis-Generator-："><a href="#Mybatis的逆向工程mbg-Mybatis-Generator-：" class="headerlink" title="Mybatis的逆向工程mbg(Mybatis Generator)："></a>Mybatis的逆向工程mbg(Mybatis Generator)：</h2><p><strong>Mybatis提供了一种尤为方便的代码生成器，对于各种懒人来说可谓是极大的福利，它可以根据表结构快速生成我们所需要的实体类、映射文件、以及各个接口，包含基本的增删改查和一些复杂操作，但是有的表结构连接等复杂查询还需要自己来写。</strong></p>
<p><strong>所需要的jar包： mybatis-generator-core-1.4.0.jar</strong></p>
<p><strong>xml:</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">generatorConfiguration</span></span></span><br><span class="line"><span class="meta">  <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD MyBatis Generator Configuration 1.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">  <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-generator-config_1_0.dtd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">generatorConfiguration</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- context相当于代码生成器的运行环境  targetRuntime为代码生成器的策略选择  --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">context</span> <span class="attr">id</span>=<span class="string">&quot;DB2Tables&quot;</span> <span class="attr">targetRuntime</span>=<span class="string">&quot;MyBatis3&quot;</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 连接到目标数据库 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">jdbcConnection</span> <span class="attr">driverClass</span>=<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span></span></span><br><span class="line"><span class="tag">		<span class="attr">connectionURL</span>=<span class="string">&quot;jdbc:mysql://localhost:3306/cygames?characterEncoding=utf-8<span class="symbol">&amp;amp;</span>serverTimezone=UTC<span class="symbol">&amp;amp;</span>useSSL=FALSE&quot;</span></span></span><br><span class="line"><span class="tag">		<span class="attr">userId</span>=<span class="string">&quot;root&quot;</span></span></span><br><span class="line"><span class="tag">		<span class="attr">password</span>=<span class="string">&quot;root&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">jdbcConnection</span>&gt;</span></span><br><span class="line">	</span><br><span class="line"><span class="comment">&lt;!-- java类型解析器 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">javaTypeResolver</span> &gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 是否强制转换bigdecimals 默认为false --&gt;</span></span><br><span class="line">	  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;forceBigDecimals&quot;</span> <span class="attr">value</span>=<span class="string">&quot;false&quot;</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">javaTypeResolver</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- javaModelGenerator定义java模型来生成javabean的，也就是指定实体类生成策略</span></span><br><span class="line"><span class="comment">	 targetPackage：为生成在的目标包</span></span><br><span class="line"><span class="comment">	 targetProject：生成在的目标项目</span></span><br><span class="line"><span class="comment"> --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">javaModelGenerator</span> <span class="attr">targetPackage</span>=<span class="string">&quot;shadowverse.card.entity&quot;</span> <span class="attr">targetProject</span>=<span class="string">&quot;.\src&quot;</span>&gt;</span></span><br><span class="line">	  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;enableSubPackages&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line">	  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;trimStrings&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">javaModelGenerator</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- sqlMapGenerator定义sql映射的生成策略 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">sqlMapGenerator</span> <span class="attr">targetPackage</span>=<span class="string">&quot;shadowverse.card.mapper&quot;</span>  <span class="attr">targetProject</span>=<span class="string">&quot;.\src&quot;</span>&gt;</span></span><br><span class="line">	  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;enableSubPackages&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">sqlMapGenerator</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 指java客户端的生成器，指定mapper接口的生成 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">javaClientGenerator</span> <span class="attr">type</span>=<span class="string">&quot;XMLMAPPER&quot;</span> <span class="attr">targetPackage</span>=<span class="string">&quot;shadowverse.card.dao&quot;</span>  <span class="attr">targetProject</span>=<span class="string">&quot;.\src&quot;</span>&gt;</span></span><br><span class="line">	  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;enableSubPackages&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">javaClientGenerator</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 指定要逆向分析的表结构 	domainObjectName表示生成对应javabean的类名 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">table</span> <span class="attr">tableName</span>=<span class="string">&quot;shadowverse&quot;</span> <span class="attr">domainObjectName</span>=<span class="string">&quot;shadow&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;/<span class="name">context</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">generatorConfiguration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>测试类(test)：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> shadowverse.card.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.generator.api.MyBatisGenerator;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.generator.config.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.generator.config.xml.ConfigurationParser;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.generator.exception.InvalidConfigurationException;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.generator.exception.XMLParserException;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.generator.internal.DefaultShellCallback;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> shadowverse.card.dao.shadowMapper;</span><br><span class="line"><span class="keyword">import</span> shadowverse.card.entity.shadow;</span><br><span class="line"><span class="keyword">import</span> shadowverse.card.entity.shadowExample;</span><br><span class="line"><span class="keyword">import</span> shadowverse.card.entity.shadowExample.Criteria;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">test</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> XMLParserException, IOException, InvalidConfigurationException, SQLException, InterruptedException </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		List&lt;String&gt; warnings = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line">		   <span class="keyword">boolean</span> overwrite = <span class="keyword">true</span>;</span><br><span class="line">		   File configFile = <span class="keyword">new</span> File(<span class="string">&quot;mbg.xml&quot;</span>);</span><br><span class="line">		   ConfigurationParser cp = <span class="keyword">new</span> ConfigurationParser(warnings);</span><br><span class="line">		   Configuration config = cp.parseConfiguration(configFile);</span><br><span class="line">		   DefaultShellCallback callback = <span class="keyword">new</span> DefaultShellCallback(overwrite);</span><br><span class="line">		   MyBatisGenerator myBatisGenerator = <span class="keyword">new</span> MyBatisGenerator(config, callback, warnings);</span><br><span class="line">		   myBatisGenerator.generate(<span class="keyword">null</span>);</span><br><span class="line">		   </span><br><span class="line">			InputStream is = test.class.getResourceAsStream(<span class="string">&quot;/mybatis.xml&quot;</span>);</span><br><span class="line">			<span class="comment">//构建sqlSession的工厂</span></span><br><span class="line">			SqlSessionFactory sessionFactory=<span class="keyword">new</span> SqlSessionFactoryBuilder().build(is);</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//获取一个sqlSession</span></span><br><span class="line">			SqlSession session = sessionFactory.openSession();</span><br><span class="line">			shadowMapper svmapper=session.getMapper(shadowMapper.class);</span><br><span class="line">			<span class="comment">//查询所有</span></span><br><span class="line">			<span class="comment">/*List&lt;shadow&gt; selectByExample=svmapper.selectByExample(null);*/</span></span><br><span class="line">			<span class="comment">//根据卡牌费用和效果查询</span></span><br><span class="line">			shadowExample se=<span class="keyword">new</span> shadowExample();</span><br><span class="line">			<span class="comment">//创建一个criteria，这个就是拼装查询条件的</span></span><br><span class="line">			Criteria ct=se.createCriteria();</span><br><span class="line">			List&lt;String&gt; cli=<span class="keyword">new</span> ArrayList();</span><br><span class="line">			cli.add(<span class="string">&quot;1&quot;</span>);</span><br><span class="line">			cli.add(<span class="string">&quot;2&quot;</span>);</span><br><span class="line">			cli.add(<span class="string">&quot;3&quot;</span>);</span><br><span class="line">			cli.add(<span class="string">&quot;4&quot;</span>);</span><br><span class="line">			cli.add(<span class="string">&quot;5&quot;</span>);</span><br><span class="line">			ct.andCCostIn(cli);</span><br><span class="line">			ct.andCEffectLike(<span class="string">&quot;%爆能%&quot;</span>);</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//添加或的条件</span></span><br><span class="line">			Criteria ct2=se.createCriteria();</span><br><span class="line">			ct2.andSClassEqualTo(<span class="string">&quot;vampire&quot;</span>);</span><br><span class="line">			se.or(ct2);</span><br><span class="line">			List&lt;shadow&gt; sli=svmapper.selectByExample(se);</span><br><span class="line">			<span class="keyword">for</span>(shadow ss:sli)&#123;</span><br><span class="line">				System.out.println(<span class="string">&quot;费用：&quot;</span>+ss.getcCost()+ss.getcName()+<span class="string">&quot; 效果：&quot;</span>+ss.getcEffect());</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">			</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>注：之后会自动生成两个实体类文件一个是基本的自命名的，一个是自命名后缀加了example的实体类文件，并且自动创建了映射mapper文件还有客户端文件接口文件,因为都太长了，这里只放出接口文件查看功能的java代码。</strong></p>
<p><img src="/img/frame/mybatisgenerator.png" alt="MyBatisGenerator"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> shadowverse.card.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Param;</span><br><span class="line"><span class="keyword">import</span> shadowverse.card.entity.shadow;</span><br><span class="line"><span class="keyword">import</span> shadowverse.card.entity.shadowExample;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">shadowMapper</span> </span>&#123;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * This method was generated by MyBatis Generator.</span></span><br><span class="line"><span class="comment">	 * This method corresponds to the database table shadowverse</span></span><br><span class="line"><span class="comment">	 *</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@mbg</span>.generated Tue Mar 24 21:38:19 CST 2020</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">long</span> <span class="title">countByExample</span><span class="params">(shadowExample example)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * This method was generated by MyBatis Generator.</span></span><br><span class="line"><span class="comment">	 * This method corresponds to the database table shadowverse</span></span><br><span class="line"><span class="comment">	 *</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@mbg</span>.generated Tue Mar 24 21:38:19 CST 2020</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">deleteByExample</span><span class="params">(shadowExample example)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * This method was generated by MyBatis Generator.</span></span><br><span class="line"><span class="comment">	 * This method corresponds to the database table shadowverse</span></span><br><span class="line"><span class="comment">	 *</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@mbg</span>.generated Tue Mar 24 21:38:19 CST 2020</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">deleteByPrimaryKey</span><span class="params">(Integer cId)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * This method was generated by MyBatis Generator.</span></span><br><span class="line"><span class="comment">	 * This method corresponds to the database table shadowverse</span></span><br><span class="line"><span class="comment">	 *</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@mbg</span>.generated Tue Mar 24 21:38:19 CST 2020</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">insert</span><span class="params">(shadow record)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * This method was generated by MyBatis Generator.</span></span><br><span class="line"><span class="comment">	 * This method corresponds to the database table shadowverse</span></span><br><span class="line"><span class="comment">	 *</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@mbg</span>.generated Tue Mar 24 21:38:19 CST 2020</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">insertSelective</span><span class="params">(shadow record)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * This method was generated by MyBatis Generator.</span></span><br><span class="line"><span class="comment">	 * This method corresponds to the database table shadowverse</span></span><br><span class="line"><span class="comment">	 *</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@mbg</span>.generated Tue Mar 24 21:38:19 CST 2020</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function">List&lt;shadow&gt; <span class="title">selectByExample</span><span class="params">(shadowExample example)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * This method was generated by MyBatis Generator.</span></span><br><span class="line"><span class="comment">	 * This method corresponds to the database table shadowverse</span></span><br><span class="line"><span class="comment">	 *</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@mbg</span>.generated Tue Mar 24 21:38:19 CST 2020</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function">shadow <span class="title">selectByPrimaryKey</span><span class="params">(Integer cId)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * This method was generated by MyBatis Generator.</span></span><br><span class="line"><span class="comment">	 * This method corresponds to the database table shadowverse</span></span><br><span class="line"><span class="comment">	 *</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@mbg</span>.generated Tue Mar 24 21:38:19 CST 2020</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">updateByExampleSelective</span><span class="params">(<span class="meta">@Param(&quot;record&quot;)</span> shadow record, <span class="meta">@Param(&quot;example&quot;)</span> shadowExample example)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * This method was generated by MyBatis Generator.</span></span><br><span class="line"><span class="comment">	 * This method corresponds to the database table shadowverse</span></span><br><span class="line"><span class="comment">	 *</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@mbg</span>.generated Tue Mar 24 21:38:19 CST 2020</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">updateByExample</span><span class="params">(<span class="meta">@Param(&quot;record&quot;)</span> shadow record, <span class="meta">@Param(&quot;example&quot;)</span> shadowExample example)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * This method was generated by MyBatis Generator.</span></span><br><span class="line"><span class="comment">	 * This method corresponds to the database table shadowverse</span></span><br><span class="line"><span class="comment">	 *</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@mbg</span>.generated Tue Mar 24 21:38:19 CST 2020</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">updateByPrimaryKeySelective</span><span class="params">(shadow record)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * This method was generated by MyBatis Generator.</span></span><br><span class="line"><span class="comment">	 * This method corresponds to the database table shadowverse</span></span><br><span class="line"><span class="comment">	 *</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@mbg</span>.generated Tue Mar 24 21:38:19 CST 2020</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">updateByPrimaryKey</span><span class="params">(shadow record)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Mybatis复杂查询："><a href="#Mybatis复杂查询：" class="headerlink" title="Mybatis复杂查询："></a>Mybatis复杂查询：</h2><h3 id="1、映射类型："><a href="#1、映射类型：" class="headerlink" title="1、映射类型："></a>1、映射类型：</h3><ul>
<li><p><strong>在Mybatis里复杂查询可以分为一对一映射类型和一对多、多对一映射类型以及多对多映射，所谓的一对一类型，相当于一个班级对应一个老师，一个老师也只能带一个班级，一对多类型相当于一个老师可以对应多个班级，但是一个班级只能有一个老师，多对多原理可以理解成一个订单可以对应多种商品，每种商品也可以对应多个订单</strong></p>
<p>  <strong>总结：说到底，无论是一对一还是多对一，就是相当于让你理清楚查询的结构，根本没有必要纠结于什么一对一还是多对一的构思，我们只需要将所要查询的东西理清楚，通过主外键约束和sql语法呈现出来就好</strong></p>
</li>
</ul>
<h3 id="2、数据库表结构："><a href="#2、数据库表结构：" class="headerlink" title="2、数据库表结构："></a>2、数据库表结构：</h3><p><img src="/img/sql/qunyou.png" alt="player_table"></p>
<p><img src="/img/sql/classes.png" alt="class_table"></p>
<p><strong>注：这里以参赛选手进行数据库表的创建，分别是选手表和选手所选的职业表</strong></p>
<h3 id="3、创建实体类："><a href="#3、创建实体类：" class="headerlink" title="3、创建实体类："></a>3、创建实体类：</h3><ul>
<li><strong>注：创建实体类同时，提前想好关联的表数据，并在实体类中创建所需要关联的对象类</strong></li>
</ul>
<p><img src="/img/java/entity.png" alt="entity"></p>
<h3 id="4、使用ResultMap进行一对一级联查询："><a href="#4、使用ResultMap进行一对一级联查询：" class="headerlink" title="4、使用ResultMap进行一对一级联查询："></a>4、使用ResultMap进行一对一级联查询：</h3><ul>
<li><strong>这里选用选手与职业进行一对一的对应关系进行级联查询，既一个选手对应一个职业，一个职业对应一个选手，分别用了级联属性和分步查询</strong></li>
</ul>
<p><strong>player操作接口(Dao)：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> shadowverse.wincup.qq.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Param;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> shadowverse.wincup.qq.entity.player;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">playerDao</span> </span>&#123;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 根据pid查询参赛选手具体信息</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> pid</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> player <span class="title">getPlayerinfoBypid</span><span class="params">(String pid)</span><span class="keyword">throws</span> RuntimeException</span>;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 根据选手id查出参赛选手信息</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> cid</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@throws</span> RuntimeException</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> player <span class="title">getPlayerinfoByStep</span><span class="params">(String pid)</span><span class="keyword">throws</span> RuntimeException</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>player映射文件(Mapper)：</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span> <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;shadowverse.wincup.qq.dao.playerDao&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">&quot;ply&quot;</span> <span class="attr">id</span>=<span class="string">&quot;playersearch&quot;</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- id为规定的主键</span></span><br><span class="line"><span class="comment">			column为数据库的字段名</span></span><br><span class="line"><span class="comment">			property为实体类的属性</span></span><br><span class="line"><span class="comment">		 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">&quot;p_id&quot;</span> <span class="attr">property</span>=<span class="string">&quot;p_id&quot;</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;p_name&quot;</span> <span class="attr">property</span>=<span class="string">&quot;p_name&quot;</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;p_age&quot;</span> <span class="attr">property</span>=<span class="string">&quot;p_age&quot;</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;p_sex&quot;</span> <span class="attr">property</span>=<span class="string">&quot;p_sex&quot;</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;p_useclassid&quot;</span> <span class="attr">property</span>=<span class="string">&quot;p_useclassid&quot;</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;p_title&quot;</span> <span class="attr">property</span>=<span class="string">&quot;p_title&quot;</span>/&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- ↓联合查询：</span></span><br><span class="line"><span class="comment">			1、级联属性封装结果集</span></span><br><span class="line"><span class="comment">		 --&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- &lt;result column=&quot;cl_id&quot; property=&quot;clas.cl_id&quot;/&gt;</span></span><br><span class="line"><span class="comment">		&lt;result column=&quot;c_name&quot; property=&quot;clas.c_name&quot;/&gt; --&gt;</span></span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">		<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">			2、使用association定义单个对象的封装规则</span></span><br><span class="line"><span class="comment">			association可以指定联合的javaBean对象</span></span><br><span class="line"><span class="comment">			property=&quot;clas&quot;,指定哪个属性是联合对象</span></span><br><span class="line"><span class="comment">			javaType:指定这个属性对象类型[不能省略]</span></span><br><span class="line"><span class="comment">		 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">&quot;clas&quot;</span> <span class="attr">javaType</span>=<span class="string">&quot;ccs&quot;</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">&quot;cl_id&quot;</span> <span class="attr">property</span>=<span class="string">&quot;cl_id&quot;</span>/&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;c_name&quot;</span> <span class="attr">property</span>=<span class="string">&quot;c_name&quot;</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">association</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getPlayerinfoBypid&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;playersearch&quot;</span>&gt;</span></span><br><span class="line">		SELECT p.p_name,p.p_age,p.p_sex,p.p_title,</span><br><span class="line">		c.c_name</span><br><span class="line">		FROM player p,cclass c WHERE p.p_useclassid=c.cl_id and p.p_id=#&#123;pid&#125;;</span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- 使用association进行分步查询 --&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 1、先按照选手id查出选手的具体信息</span></span><br><span class="line"><span class="comment">		 2、再根据查出选手具体信息中的职业id查出所选的职业</span></span><br><span class="line"><span class="comment">	 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">&quot;ply&quot;</span> <span class="attr">id</span>=<span class="string">&quot;playersearchStep&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">&quot;p_id&quot;</span> <span class="attr">property</span>=<span class="string">&quot;p_id&quot;</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;p_name&quot;</span> <span class="attr">property</span>=<span class="string">&quot;p_name&quot;</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;p_age&quot;</span> <span class="attr">property</span>=<span class="string">&quot;p_age&quot;</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;p_sex&quot;</span> <span class="attr">property</span>=<span class="string">&quot;p_sex&quot;</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;p_useclassid&quot;</span> <span class="attr">property</span>=<span class="string">&quot;p_useclassid&quot;</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;p_title&quot;</span> <span class="attr">property</span>=<span class="string">&quot;p_title&quot;</span>/&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- association定义关联对象封装规则 --&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- select：表明当前属性调用指定的方法查出的结果 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">&quot;clas&quot;</span> <span class="attr">javaType</span>=<span class="string">&quot;ccs&quot;</span></span></span><br><span class="line"><span class="tag">		<span class="attr">select</span>=<span class="string">&quot;shadowverse.wincup.qq.dao.classDao.getclassBycid&quot;</span></span></span><br><span class="line"><span class="tag">		<span class="attr">column</span>=<span class="string">&quot;p_useclassid&quot;</span>/&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- column：指定将哪一列的值传给这个方法↑ --&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getPlayerinfoByStep&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;playersearchStep&quot;</span>&gt;</span></span><br><span class="line">		select * from player where p_id=#&#123;pid&#125;;</span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>注：使用分步查询的时候，需要在关联的class类里，写上分步查询的接口和实现</strong></p>
<p><strong>class接口(Dao)：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 根据职业id查询出对应职业</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> cid</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@throws</span> RuntimeException</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> cclass <span class="title">getclassBycid</span><span class="params">(String cid)</span><span class="keyword">throws</span> RuntimeException</span>;</span><br></pre></td></tr></table></figure>
<p><strong>class映射文件(mapper)：</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getclassBycid&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;ccs&quot;</span>&gt;</span></span><br><span class="line">	select * from cclass where cl_id=#&#123;cid&#125;;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>player测试类(test)：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> shadowverse.wincup.qq.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> shadowverse.wincup.qq.dao.playerDao;</span><br><span class="line"><span class="keyword">import</span> shadowverse.wincup.qq.entity.player;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">playertest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		InputStream is = playertest.class.getResourceAsStream(<span class="string">&quot;/Mybatis.xml&quot;</span>);</span><br><span class="line">		<span class="comment">//构建sqlSession的工厂</span></span><br><span class="line">		SqlSessionFactory sessionFactory=<span class="keyword">new</span> SqlSessionFactoryBuilder().build(is);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//获取一个sqlSession</span></span><br><span class="line">		SqlSession session = sessionFactory.openSession();</span><br><span class="line">		playerDao pdao=session.getMapper(playerDao.class);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//一对一查询</span></span><br><span class="line">		player pla=pdao.getPlayerinfoBypid(<span class="string">&quot;szb006&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;姓名： &quot;</span>+pla.getP_name()+<span class="string">&quot;\n性别：&quot;</span>+pla.getP_sex()+<span class="string">&quot;\n年龄：&quot;</span>+pla.getP_age()+<span class="string">&quot;\n称号：&quot;</span>+pla.getP_title()</span><br><span class="line">		+<span class="string">&quot;\n职业：&quot;</span>+pla.getClas().getC_name());</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//一对一分步查询↓</span></span><br><span class="line">		System.out.println(<span class="string">&quot;---------------------------------&quot;</span>);</span><br><span class="line">		player ply=pdao.getPlayerinfoByStep(<span class="string">&quot;szb001&quot;</span>);</span><br><span class="line">		System.out.println(<span class="string">&quot;姓名： &quot;</span>+ply.getP_name()+<span class="string">&quot;\n性别：&quot;</span>+ply.getP_sex()+<span class="string">&quot;\n年龄：&quot;</span>+ply.getP_age()+<span class="string">&quot;\n称号：&quot;</span>+ply.getP_title()</span><br><span class="line">		+<span class="string">&quot;\n职业：&quot;</span>+ply.getClas().getC_name());</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="5、一对多和多对一的级联查询："><a href="#5、一对多和多对一的级联查询：" class="headerlink" title="5、一对多和多对一的级联查询："></a>5、一对多和多对一的级联查询：</h3><ul>
<li><strong>这里选用选手和职业进行多对一的关系查询，既一个选手对应一个职业，但是一个职业可以对应多个选手</strong></li>
</ul>
<p><strong>class操作接口(Dao)：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> shadowverse.wincup.qq.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> shadowverse.wincup.qq.entity.cclass;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 根据职业id查询出对应成员信息以及部门</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> cid</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@throws</span> RuntimeException</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> cclass <span class="title">getclassandPlayer</span><span class="params">(String cid)</span><span class="keyword">throws</span> RuntimeException</span>;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 根据职业的id分步查询出选手和职业信息</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> cid</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@throws</span> RuntimeException</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> cclass <span class="title">getclsandplyBystep</span><span class="params">(String cid)</span><span class="keyword">throws</span> RuntimeException</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>class映射文件(mapper)：</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span> <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;shadowverse.wincup.qq.dao.classDao&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">&quot;ccs&quot;</span> <span class="attr">id</span>=<span class="string">&quot;classsearch&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">&quot;cl_id&quot;</span> <span class="attr">property</span>=<span class="string">&quot;cl_id&quot;</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;c_name&quot;</span> <span class="attr">property</span>=<span class="string">&quot;c_name&quot;</span>/&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- collection定义关联的集合类型属性封装规则</span></span><br><span class="line"><span class="comment">			 ofType:指定集合内元素类型</span></span><br><span class="line"><span class="comment">		 --&gt;</span>	</span><br><span class="line">		<span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">&quot;pla&quot;</span> <span class="attr">ofType</span>=<span class="string">&quot;ply&quot;</span>&gt;</span></span><br><span class="line">			<span class="comment">&lt;!-- 定义集合中封装元素规则 --&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">&quot;p_id&quot;</span> <span class="attr">property</span>=<span class="string">&quot;p_id&quot;</span>/&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;p_name&quot;</span> <span class="attr">property</span>=<span class="string">&quot;p_name&quot;</span>/&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;p_age&quot;</span> <span class="attr">property</span>=<span class="string">&quot;p_age&quot;</span>/&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;p_sex&quot;</span> <span class="attr">property</span>=<span class="string">&quot;p_sex&quot;</span>/&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;p_useclassid&quot;</span> <span class="attr">property</span>=<span class="string">&quot;p_useclassid&quot;</span>/&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;p_title&quot;</span> <span class="attr">property</span>=<span class="string">&quot;p_title&quot;</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getclassandPlayer&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;classsearch&quot;</span>&gt;</span></span><br><span class="line">		SELECT c.cl_id,c.c_name,p.p_id,</span><br><span class="line">		p.p_name,</span><br><span class="line">		p.p_sex,</span><br><span class="line">		p.p_age,</span><br><span class="line">		p.p_title FROM cclass c left join player p on c.cl_id=p.p_useclassid WHERE c.cl_id=#&#123;cid&#125;;</span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- 分步查询 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">&quot;ccs&quot;</span> <span class="attr">id</span>=<span class="string">&quot;classstep&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">&quot;cl_id&quot;</span> <span class="attr">property</span>=<span class="string">&quot;cl_id&quot;</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;c_name&quot;</span> <span class="attr">property</span>=<span class="string">&quot;c_name&quot;</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">&quot;pla&quot;</span> </span></span><br><span class="line"><span class="tag">		<span class="attr">select</span>=<span class="string">&quot;shadowverse.wincup.qq.dao.playerDao.getPlayerinfoBycid&quot;</span> </span></span><br><span class="line"><span class="tag">		<span class="attr">column</span>=<span class="string">&quot;cl_id&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getclsandplyBystep&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;classstep&quot;</span>&gt;</span></span><br><span class="line">		select * from cclass where cl_id=#&#123;cid&#125;;</span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>这里一对多和一对一的分步查询操作一样，需要在player类中添加分步第一步查询的接口和映射文件</strong></p>
<p><strong>class测试类(test)：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> shadowverse.wincup.qq.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> shadowverse.wincup.qq.dao.classDao;</span><br><span class="line"><span class="keyword">import</span> shadowverse.wincup.qq.entity.cclass;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">playertest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		InputStream is = playertest.class.getResourceAsStream(<span class="string">&quot;/Mybatis.xml&quot;</span>);</span><br><span class="line">		<span class="comment">//构建sqlSession的工厂</span></span><br><span class="line">		SqlSessionFactory sessionFactory=<span class="keyword">new</span> SqlSessionFactoryBuilder().build(is);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//获取一个sqlSession</span></span><br><span class="line">		SqlSession session = sessionFactory.openSession();</span><br><span class="line"></span><br><span class="line">		<span class="comment">//集合中一对多，多对一查询</span></span><br><span class="line">		System.out.println(<span class="string">&quot;++++++++++++++++++++++++++++++++++&quot;</span>);</span><br><span class="line">		classDao csdao=session.getMapper(classDao.class);</span><br><span class="line">		cclass clss=csdao.getclassandPlayer(<span class="string">&quot;4&quot;</span>);</span><br><span class="line">		System.out.println(clss);</span><br><span class="line">		System.out.println(clss.getPla());</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//一对多，多对一分步查询</span></span><br><span class="line">		System.out.println(<span class="string">&quot;++++++++++++++++++++++++++++++++++&quot;</span>);</span><br><span class="line">		cclass cla=csdao.getclsandplyBystep(<span class="string">&quot;2&quot;</span>);</span><br><span class="line">		System.out.println(cla);</span><br><span class="line">		System.out.println(cla.getPla());</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>总结：使用ResultMap进行联合查询的操作虽然逻辑清楚，但是代码复杂，（总而言之废话太多），所以我还是推荐ResultType进行返回Map类型来传递关联数据，最后接收参数和进行参数调用</strong></li>
</ul>
</article><!-- lincense--><div class="license-wrapper"><p> <span>Author:  </span><a href="https://neptunetwilight.github.io">TwilightCoder</a></p><p> <span>Link:  </span><a href="https://neptunetwilight.github.io/2021/02/06/MyBatis/">https://neptunetwilight.github.io/2021/02/06/MyBatis/</a></p><p> <span>Copyright:  </span><span>All articles in this blog are licensed under <a rel="license noopener" target="_blank" href="https://creativecommons.org/licenses/by-nc-nd/3.0">CC BY-NC-SA 3.0</a> unless stating additionally.</span></p></div><div class="post-paginator"><a class="prevSlogan" href="/2021/02/06/yml%E8%AF%AD%E6%B3%95/" title="yml语法"><span>< PreviousPost</span><br><span class="prevTitle">yml语法</span></a><a class="nextSlogan" href="/2021/02/05/Spring%E5%92%8CSpring-mvc%E6%A1%86%E6%9E%B6%E5%8E%9F%E7%90%86%E4%BB%A5%E5%8F%8A%E5%BA%94%E7%94%A8/" title="Spring和Spring-mvc框架原理以及应用"><span>NextPost ></span><br><span class="nextTitle">Spring和Spring-mvc框架原理以及应用</span></a><div class="clear"></div></div><div id="comment"></div></section></article><div id="musicMouseDrag" style="position:fixed; z-index: 9999; bottom: 0; right: 0;"><div id="musicDragArea" style="position: absolute; top: 0; left: 0; width: 100%;height: 10px;cursor: move; z-index: 10;"></div><link rel="stylesheet" href="/dist/APlayer.min.css"><div id="aplayer"></div><script type="text/javascript" src="/dist/APlayer.min.js"></script><script type="text/javascript" src="/dist/music.js"></script></div><footer id="cxo-footer-outer"><div id="cxo-footer-inner"><p class="footer-container"><span>Site by </span><a target="_blank" rel="noopener" href="http://hexo.io"><span>Hexo</span></a><span> | theme </span><a target="_blank" rel="noopener" href="https://github.com/Longlongyu/hexo-theme-Cxo"><span>Cxo</span></a></p><i class="fa fa-user"> </i><span id="busuanzi_value_site_uv"></span><span> | </span><i class="fa fa-eye"> </i><span id="busuanzi_value_site_pv"></span><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?" + 'var _hmt = _hmt || []; (function() { var hm = document.createElement("script"); hm.src = "https://hm.baidu.com/hm.js?800f627451dc58b62e719fdfcbf4c40e"; var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s); })();';
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();</script></div></footer><!-- catelog--><div class="toc-wrapper" style="top: 70vh;"><div class="toc-catalog"><i class="fa fa-list"> </i><span>CATALOG</span></div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#MyBatis%E7%AE%80%E4%BB%8B"><span class="toc-number">1.</span> <span class="toc-text">MyBatis简介:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Mybatis%E9%85%8D%E7%BD%AE"><span class="toc-number">2.</span> <span class="toc-text">Mybatis配置:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Mybatis%E9%87%8C%E7%9A%84%E5%8A%A8%E6%80%81sql%EF%BC%9A"><span class="toc-number">3.</span> <span class="toc-text">Mybatis里的动态sql：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Mybatis%E7%9A%84%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8Bmbg-Mybatis-Generator-%EF%BC%9A"><span class="toc-number">4.</span> <span class="toc-text">Mybatis的逆向工程mbg(Mybatis Generator)：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Mybatis%E5%A4%8D%E6%9D%82%E6%9F%A5%E8%AF%A2%EF%BC%9A"><span class="toc-number">5.</span> <span class="toc-text">Mybatis复杂查询：</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E6%98%A0%E5%B0%84%E7%B1%BB%E5%9E%8B%EF%BC%9A"><span class="toc-number">5.1.</span> <span class="toc-text">1、映射类型：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E6%95%B0%E6%8D%AE%E5%BA%93%E8%A1%A8%E7%BB%93%E6%9E%84%EF%BC%9A"><span class="toc-number">5.2.</span> <span class="toc-text">2、数据库表结构：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E5%88%9B%E5%BB%BA%E5%AE%9E%E4%BD%93%E7%B1%BB%EF%BC%9A"><span class="toc-number">5.3.</span> <span class="toc-text">3、创建实体类：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%E3%80%81%E4%BD%BF%E7%94%A8ResultMap%E8%BF%9B%E8%A1%8C%E4%B8%80%E5%AF%B9%E4%B8%80%E7%BA%A7%E8%81%94%E6%9F%A5%E8%AF%A2%EF%BC%9A"><span class="toc-number">5.4.</span> <span class="toc-text">4、使用ResultMap进行一对一级联查询：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5%E3%80%81%E4%B8%80%E5%AF%B9%E5%A4%9A%E5%92%8C%E5%A4%9A%E5%AF%B9%E4%B8%80%E7%9A%84%E7%BA%A7%E8%81%94%E6%9F%A5%E8%AF%A2%EF%BC%9A"><span class="toc-number">5.5.</span> <span class="toc-text">5、一对多和多对一的级联查询：</span></a></li></ol></li></ol></div><!-- top--><i class="fa fa-arrow-up close" id="go-up" aria-hidden="true"></i><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/assets/shizuku.model.json"},"display":{"position":"right","width":200,"height":300,"hOffset":60,"vOffset":0},"mobile":{"show":true},"react":{"opacity":1},"log":false});</script></body></html>